import '../copy_with_sentinel.dart';

/// Code execution language.
enum Language {
  /// Unspecified language.
  unspecified,

  /// Python.
  python,
}

/// Code generated by the model that is meant to be executed.
class ExecutableCode {
  /// Programming language of the code.
  final Language language;

  /// The code to execute.
  final String code;

  /// Creates an [ExecutableCode].
  const ExecutableCode({required this.language, required this.code});

  /// Creates an [ExecutableCode] from JSON.
  factory ExecutableCode.fromJson(Map<String, dynamic> json) => ExecutableCode(
    language: _languageFromString(json['language'] as String?),
    code: json['code'] as String,
  );

  /// Converts to JSON.
  Map<String, dynamic> toJson() => {
    'language': _languageToString(language),
    'code': code,
  };

  /// Creates a copy with replaced values.
  ExecutableCode copyWith({
    Object? language = unsetCopyWithValue,
    Object? code = unsetCopyWithValue,
  }) {
    return ExecutableCode(
      language: language == unsetCopyWithValue
          ? this.language
          : language! as Language,
      code: code == unsetCopyWithValue ? this.code : code! as String,
    );
  }
}

/// Converts string to Language enum.
Language _languageFromString(String? value) {
  return switch (value?.toUpperCase()) {
    'PYTHON' => Language.python,
    _ => Language.unspecified,
  };
}

/// Converts Language enum to string.
String _languageToString(Language language) {
  return switch (language) {
    Language.python => 'PYTHON',
    Language.unspecified => 'LANGUAGE_UNSPECIFIED',
  };
}
